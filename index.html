<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FixMyCar AI</title>
    <link rel="stylesheet" href="/style.css" />
</head>

<body>
    <header>
        <h1>üîß FixMyCar <span class="ai">AI</span></h1>
        <p>Diagn√≥stico inteligente + gu√≠as de reparaci√≥n paso a paso</p>
        <a class="blog-link" href="/blog/index.html">üìò Ver blog de gu√≠as FixMyCarAI</a>
    </header>

    <main>
        <section class="input-section">
            <h2>Describe el problema de tu veh√≠culo</h2>

            <label>Veh√≠culo (a√±o, marca, modelo o VIN)</label>
            <input id="vehicle" type="text" placeholder="Ej. Ford Lobo 2005 Trit√≥n 5.4" />

            <label>S√≠ntomas / descripci√≥n del problema</label>
            <textarea id="symptoms" placeholder="Ej. patina transmisi√≥n en 3ra..."></textarea>

            <button id="analyzeBtn">üöó Analizar con FixMyCar AI</button>
            <small>Tip: mientras m√°s detalles des, mejor el diagn√≥stico.</small>
        </section>

        <section class="chat-section">
            <h2>Chat de diagn√≥stico</h2>
            <div id="chat"></div>
        </section>
    </main>

<script>
document.getElementById("analyzeBtn").onclick = async () => {
    const vehicle = document.getElementById("vehicle").value.trim();
    const symptoms = document.getElementById("symptoms").value.trim();
    const chat = document.getElementById("chat");

    chat.innerHTML += `<div class="msg user"><strong>T√∫:</strong> Veh√≠culo: ${vehicle}<br> S√≠ntomas: ${symptoms}</div>`;
    chat.innerHTML += `<div class="msg ai"><strong>FixMyCar AI:</strong> ‚è≥ Analizando... por favor espera unos segundos.</div>`;

    const res = await fetch("/api/diagnose", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: symptoms })
    });

    const data = await res.json();

    if (data.error) {
        chat.innerHTML += `<div class="msg ai error">‚ö†Ô∏è Error conectando al servidor. Int√©ntalo nuevamente.</div>`;
        return;
    }

    const html = `
        <div class="msg ai">
            <strong>FixMyCar AI:</strong><br>
            <h4>Posibles causas:</h4>
            <ul>${(data.hypotheses || []).map(v => `<li>${v}</li>`).join("")}</ul>

            <h4>Acciones recomendadas:</h4>
            <ul>${(data.actions || []).map(v => `<li>${v}</li>`).join("")}</ul>

            <h4>Fallas comunes del modelo:</h4>
            <ul>${(data.common_failures || []).map(v => `<li>${v}</li>`).join("")}</ul>
        </div>
    `;

    chat.innerHTML += html;
};
</script>

</body>
</html>
